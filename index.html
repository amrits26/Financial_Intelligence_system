<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Financial Intelligence System</title>
  <link rel="icon" href="/static/favicon.ico" />
  <link rel="stylesheet" href="/static/styles.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script defer src="/static/app.js"></script>
</head>

<body>
  <div class="shell">
    <header class="topbar">
      <div class="brand">
        <div class="dot"></div>
        <div>
          <div class="title">Financial Intelligence</div>
          <div class="subtitle">Apple-style stock analysis dashboard</div>
        </div>
      </div>

      <div class="actions">
        <a class="ghost" href="/api/docs" target="_blank" rel="noreferrer">API Docs</a>
      </div>
    </header>

    <main class="grid">
      <!-- HERO -->
      <section class="card hero">
        <div class="hero-left">
          <h1>Analyze a ticker</h1>
          <p class="muted">
            Enter a NYSE/Nasdaq ticker and generate fundamentals, technicals, risk metrics, and an AI-synthesized recommendation.
          </p>

          <div class="input-row">
            <input id="ticker" type="text" inputmode="text" placeholder="AAPL, MSFT, NVDA…" autocomplete="off" />
            <button id="run">Analyze</button>
          </div>

          <div class="status" id="status"></div>
        </div>

        <div class="hero-right">
          <div class="pill">
            <span class="k">Endpoint</span>
            <span class="v">POST /api/analyze</span>
          </div>
          <div class="pill">
            <span class="k">Request</span>
            <span class="v">{ "ticker": "AAPL" }</span>
          </div>
          <div class="pill">
            <span class="k">Response</span>
            <span class="v">Metrics + Recommendation</span>
          </div>
        </div>
      </section>

      <!-- RECOMMENDATION -->
      <section class="card">
        <div class="card-head">
          <h2>Recommendation</h2>
          <div class="badge" id="recBadge">—</div>
        </div>

        <div class="two-col">
          <div>
            <div class="label">Risk level</div>
            <div class="big" id="riskLevel">—</div>
          </div>
          <div>
            <div class="label">Analysis date</div>
            <div class="big" id="analysisDate">—</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="label">Reasoning</div>
        <p class="readable" id="reasoning">Run an analysis to see reasoning.</p>

        <div class="label">Key drivers</div>
        <ul class="drivers" id="drivers"></ul>
      </section>

      <!-- METRICS -->
      <section class="card">
        <div class="card-head">
          <h2>Metrics</h2>
          <div class="chip" id="tickerChip">—</div>
        </div>

        <div class="metric-grid">
          <div class="metric">
            <div class="label">Current price</div>
            <div class="value" id="price">—</div>
          </div>
          <div class="metric">
            <div class="label">RSI (14)</div>
            <div class="value" id="rsi">—</div>
          </div>
          <div class="metric">
            <div class="label">MACD trend</div>
            <div class="value" id="trend">—</div>
          </div>
          <div class="metric">
            <div class="label">Volatility</div>
            <div class="value" id="vol">—</div>
          </div>
          <div class="metric">
            <div class="label">Sharpe</div>
            <div class="value" id="sharpe">—</div>
          </div>
          <div class="metric">
            <div class="label">Current drawdown</div>
            <div class="value" id="cdd">—</div>
          </div>
        </div>

        <div class="divider"></div>

        <!-- ✅ Enhanced visuals (keeps your original #chart so app.js still works) -->
        <div class="viz-grid">
          <!-- Left: RSI Gauge (optional – app.js can populate later) -->
          <div class="viz-card">
            <div class="label">RSI Gauge</div>
            <div class="gauge">
              <svg viewBox="0 0 120 120">
                <circle class="g-bg" cx="60" cy="60" r="46"></circle>
                <circle class="g-fg" id="rsiRing" cx="60" cy="60" r="46"></circle>
              </svg>
              <div class="g-center">
                <div class="g-value" id="rsiBig">—</div>
                <div class="g-sub" id="rsiTag">—</div>
              </div>
            </div>
            <p class="tiny muted" style="margin: 6px 0 0;">
              Oversold &lt; 30 • Neutral 30–70 • Overbought &gt; 70
            </p>
          </div>

          <!-- Right: Signals + existing snapshot chart -->
          <div class="viz-card">
            <div class="label">Signals</div>
            <div class="pills">
              <span class="pill2" id="trendPill">Trend: —</span>
              <span class="pill2" id="riskPill">Risk: —</span>
              <span class="pill2" id="recPill">Rec: —</span>
            </div>

            <div class="divider thin"></div>

            <!-- ✅ Keep this EXACTLY so your current JS still works -->
            <div class="label">Snapshot chart</div>
            <canvas id="chart" height="120"></canvas>
            <p class="tiny muted">
              Chart is a simple “signal snapshot” from returned indicators (not price history).
            </p>
          </div>
        </div>
      </section>

      <!-- RAW JSON -->
      <section class="card wide">
        <div class="card-head">
          <h2>Raw JSON</h2>
          <button class="ghost" id="copyJson">Copy</button>
        </div>
        <pre class="json" id="rawJson">{}</pre>
      </section>
    </main>

    <footer class="footer muted">
      Built on your existing FastAPI pipeline. UI calls your backend without modifying it.
    </footer>
  </div>
</body>
</html>
